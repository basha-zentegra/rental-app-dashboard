<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduled Rentals Calendar</title>

    <link rel="stylesheet" href="styles.css">

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            /* padding: 20px; */
        }

        .calendar-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #fff;
            padding: 15px 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .header-left h1 {
            font-size: 24px;
            color: #333;
            margin-right: 20px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .btn-add {
            background: #20b2aa;
            color: white;
        }

        .btn-add:hover {
            background: #189a93;
        }

        .btn-nav {
            background: #20b2aa;
            color: white;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-view {
            background: #f0f0f0;
            color: #333;
            border: 1px solid #ddd;
        }

        .btn-view.active {
            background: #20b2aa;
            color: white;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 8px 35px 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }

        .search-box::after {
            content: 'üîç';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .calendar-wrapper {
            height: 600px;
        }

        .calendar-grid {
            width: 100%;
            overflow-x: auto;
        }

        .month-header {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            font-size: 18px;
            font-weight: 600;
            color: #333;
            display: flex;
            justify-content: center;
            gap: 20px;
            align-items: center;
        }

        .calendar-table {
            width: 100%;
            border-collapse: collapse;
        }

        .rental-header {
            background: #f8f9fa;
            padding: 12px 15px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            border: 1px solid #e0e0e0;
            width: 200px;
            position: relative;
        }

        /* .rental-header::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #666;
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
        } */

        .day-header {
            background: #f8f9fa;
            padding: 8px 4px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            border: 1px solid #e0e0e0;
            min-width: 35px;
        }

        .calendar-cell {
            border: 1px solid #e0e0e0;
            height: 80px;
            position: relative;
            vertical-align: top;
            min-width: 35px;
            padding: 2px;
        }

        .calendar-row {
            position: relative;
        }

        .booking {
            position: absolute;
            height: 25px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 11px;
            color: white;
            cursor: pointer;
            overflow: hidden;
            white-space: nowrap;
            z-index: 10;
        }

        .booking-projector {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
        }

        .booking-printer {
            background: linear-gradient(135deg, #4ecdc4, #7ed9d1);
        }

        .booking-meeting {
            background: linear-gradient(135deg, #45b7d1, #96ccdc);
        }

        .booking:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .weekend {
            background-color: #f8f8f8;
        }

        .today {
            background-color: #fff3cd;
        }

        .day-number {
            font-size: 12px;
            color: #666;
            margin: 2px;
        }

        .booking-tooltip {
        position: absolute;
        background: white;
        border: 1px solid #ccc;
        /* padding: 8px 12px; */
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        border-radius: 4px;
        font-size: 14px;
        z-index: 9999;
        display: none;
        min-width: 200px;
        }

        .booking-tooltip ul {
        padding: 8px 12px;
        list-style: none;
        padding: 0;
        margin: 0;
        }

        .booking-tooltip ul li {
        margin-bottom: 4px;
        }


        @media (max-width: 768px) {
            .calendar-wrapper {
                flex-direction: column;
                height: auto;
            }
            
            .rental-list {
                width: 100%;
                display: flex;
                overflow-x: auto;
            }
            
            .rental-item {
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="calendar-container">
        <div class="header">
            <div class="header-left">
                <h1>Scheduled Rentals</h1>
                <button class="btn btn-add">ADD</button>
                <div style="display: flex; gap: 5px;">
                    <!-- <button class="btn btn-nav" onclick="previousMonth()">‚Äπ</button> -->
                    <!-- <button class="btn btn-nav" onclick="nextMonth()">‚Ä∫</button> -->
                </div>
                <div style="display: flex; gap: 5px;">
                    <!-- <button class="btn btn-view">DAY</button> -->
                    <!-- <button class="btn btn-view">WEEK</button> -->
                    <!-- <button class="btn btn-view active">MONTH</button> -->
                    <!-- <button class="btn btn-view">YEAR</button> -->
                </div>
            </div>
            <div class="header-right">
                <!-- <span>üîΩ Filters</span>
                <span>üìä Group By</span>
                <span>‚≠ê Favorites</span> -->
                <div class="search-box">
                    <input type="text" placeholder="Search..." id="searchInput">
                </div>
            </div>
        </div>

        <div class="calendar-wrapper">
            <div class="calendar-grid">
                <div class="month-header" id="monthHeader"> June 2021 </div>
                <table class="calendar-table">
                    <thead>
                        <tr id="headerRow">
                            <th class="rental-header">Rental</th>
                            <!-- Day headers will be generated by JavaScript -->
                        </tr>
                    </thead>
                    <tbody id="calendarBody">
                        <!-- Calendar rows will be generated by JavaScript -->
                    </tbody>
                </table>

                <!-- modal  -->

                <!-- Booking Details Modal -->
<div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="bookingModalLabel">Booking Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="bookingModalBody">
        <!-- Content will be injected dynamically -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


                <!-- end  -->


            </div>
        </div>
    </div>

    <div style="background-color: rgb(196, 201, 255);"></div>

    <script>
        let currentDate = new Date(); // Start with current month instead of fixed June 2021
        
        const bookings = [
            // Projector bookings - these will appear in the Projector row
            {
                id: 1,
                item: 'projector',
                customer: 'Deco Addict, S00021',
                startDay: 12,
                duration: 6,
                offset: 10
            },
            {
                id: 2,
                item: 'projector',
                customer: 'Deco Addict, S00021',
                startDay: 18,
                duration: 8,
                offset: 40
            },
            // Printer bookings - these will appear in the Printer row
            {
                id: 3,
                item: 'printer',
                customer: 'Azure',
                startDay: 18,
                duration: 2,
                offset: 10
            },
            {
                id: 4,
                item: 'printer',
                customer: 'Deco Addict, S00044',
                startDay: 19,
                duration: 4,
                offset: 35
            },
            {
                id: 5,
                item: 'printer',
                customer: 'Deco Addict, S00044',
                startDay: 27,
                duration: 5,
                offset: 10
            },
         
            // Meeting room has no bookings in this example
        ];

        function generateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            let daysWidth = 0;

            // console.log("daysInMonth", daysInMonth)
            console.log(`Width: ${window.innerWidth}px, Height: ${window.innerHeight}px`);

            // console.warn(window.innerWidth)


            // if(window.innerWidth === 1600){
            //     console.warn(window.innerWidth)
            //     if (daysInMonth === 31){
            //         // daysWidth = 43.7;
            //         daysWidth = 45.06;
            //     } else if(daysInMonth === 30){
            //         // daysWidth = 45.23
            //         daysWidth = 46.56
            //     } else if(daysInMonth === 28){
            //         // daysWidth = 48.5
            //         daysWidth = 49.89
            //     } else if(daysInMonth=== 29){
            //         daysWidth = 48.17
            //     }
            // }else if(window.innerWidth === 1536){
            //     console.warn(window.innerWidth)
            //     if (daysInMonth === 31){
            //         // daysWidth = 43.1;
            //         daysWidth = (window.innerWidth - 200) / daysInMonth
            //         console.log(daysWidth)
            //     }
            //     // else if(daysInMonth === 30){
            //     //     // daysWidth = 45.23
            //     //     daysWidth = 46.56
            //     // } else if(daysInMonth === 28){
            //     //     // daysWidth = 48.5
            //     //     daysWidth = 49.89
            //     // } else if(daysInMonth=== 29){
            //     //     daysWidth = 48.17
            //     // }
            // }

            daysWidth = (window.innerWidth - 200) / daysInMonth

            
            // Update month header
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            document.getElementById('monthHeader').innerHTML = `
            <button class="btn btn-nav" onclick="previousMonth()">‚Äπ</button>
            <div style="width:180px">${monthNames[month]} ${year}</div>
            <button class="btn btn-nav" onclick="nextMonth()">‚Ä∫</button>
            `;
            
            // Generate day headers dynamically based on days in month
            const headerRow = document.getElementById('headerRow');
            // Clear existing day headers (keep the Rental header)
            while (headerRow.children.length > 1) {
                headerRow.removeChild(headerRow.lastChild);
            }
            
            // Add day headers for the current month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayHeader = document.createElement('th');
                dayHeader.className = 'day-header';
                dayHeader.textContent = String(day).padStart(2, '0');
                headerRow.appendChild(dayHeader);
            }
            
            // Generate calendar body
            const calendarBody = document.getElementById('calendarBody');
            calendarBody.innerHTML = '';
            
            // Create rows for each rental item - exactly matching the sidebar
            const rentalItems = [
                { name: '[RENT001] Projector', key: 'projector' },
                { name: '[RENT003] Printer', key: 'printer' },
                { name: 'Meeting Room', key: 'meeting' }
            ];
            
            rentalItems.forEach((item, rowIndex) => {

                const row = document.createElement('tr');
                row.className = 'calendar-row';

                row.setAttribute('data-rental', item.key);
                
                // First cell is the rental item header
                const headerCell = document.createElement('td');
                headerCell.className = 'rental-header';
                headerCell.textContent = item.name;
                headerCell.setAttribute('colspan', '32');
                headerCell.style.backgroundColor = "#dee2e6";
                headerCell.style.borderBottom = "1px solid grey"
                // row.appendChild(headerCell);
                calendarBody.appendChild(headerCell)

                // First cell is the rental item header
                const sidebar = document.createElement('td');
                sidebar.className = 'rental-header';
                // sidebar.textContent = item.name;
                // sidebar.textContent = "-";
                sidebar.innerText= '';
                row.appendChild(sidebar);
                
                
                // Then add the day cells based on actual days in month
                for (let day = 1; day <= daysInMonth; day++) {
                    const cell = document.createElement('td');
                    cell.className = 'calendar-cell';
                    
                    // Check if it's weekend
                    const dayOfWeek = new Date(year, month, day).getDay();
                    if (dayOfWeek === 0 || dayOfWeek === 6) {
                        cell.classList.add('weekend');
                    }
                    
                    // Check if it's today
                    const today = new Date();
                    if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
                        cell.classList.add('today');
                    }
                    
                    row.appendChild(cell);
                }
                
                calendarBody.appendChild(row);
            });
            
            // Add bookings after a short delay to ensure DOM is ready
            setTimeout(addBookings(daysWidth), 100);
        }

        function addBookings(daysWidth) {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            bookings.forEach(booking => {
                // Only show bookings that fit within the current month
                if (booking.startDay <= daysInMonth && booking.startDay + booking.duration - 1 <= daysInMonth) {
                    // Find the correct row based on the rental item
                    const targetRow = document.querySelector(`[data-rental="${booking.item}"]`);
                    
                    if (targetRow) {
                        const bookingEl = document.createElement('div');
                        bookingEl.className = `booking booking-${booking.item}`;
                        bookingEl.textContent = booking.customer;
                        // <span class="tooltip-text">Delete</span>
                        bookingEl.title = `${booking.customer} - ${booking.duration} days`;
                        
                        // Calculate position and width (accounting for the rental header column)
                        const cellWidth = daysWidth; // minimum cell width
                        const startPos = 200 + (booking.startDay - 1) * cellWidth + 0; // 200px is the header width
                        const endDay = Math.min(booking.startDay + booking.duration - 1, daysInMonth);
                        const actualDuration = endDay - booking.startDay + 1;
                        const width = actualDuration * cellWidth - 6; // -6 for better spacing
                        
                        bookingEl.style.left = startPos + 'px';
                        bookingEl.style.width = width + 'px';
                        bookingEl.style.top = (booking.offset || 10) + 'px';
                        
                        targetRow.appendChild(bookingEl);
                        
                        // Add click event
                        // bookingEl.addEventListener('click', function() {
                        //     alert(`Booking Details:\nCustomer: ${booking.customer}\nDuration: ${booking.duration} days\nItem: ${booking.item}`);
                        // });
                        // Add click event
                        // bookingEl.addEventListener('click', function () {
                        //     const modalBody = document.getElementById('bookingModalBody');
                        //     modalBody.innerHTML = `
                        //         <p><strong>Customer:</strong> ${booking.customer}</p>
                        //         <p><strong>Duration:</strong> ${booking.duration} days</p>
                        //         <p><strong>Item:</strong> ${booking.item}</p>
                        //     `;

                        //     // Show the modal using Bootstrap JS
                        //     const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
                        //     bookingModal.show();
                        // });

                        // Create the tooltip element (only once)
                        let tooltip = document.getElementById('bookingTooltip');
                        if (!tooltip) {
                            tooltip = document.createElement('div');
                            tooltip.id = 'bookingTooltip';
                            tooltip.className = 'booking-tooltip';
                            document.body.appendChild(tooltip);
                        }

                        // Add click event to show tooltip
                        bookingEl.addEventListener('click', function (e) {
                            e.stopPropagation(); // prevent body click from closing it immediately

                            const content = `
                            <div class="p-1 py-2" style="background-color: rgb(196, 201, 255);"><strong>${booking.customer}, ${booking.orderNo || booking.item}</strong></div>
                            <div class="p-2">
                                <ul>
                                    <li><strong>Order #:</strong> ${booking.orderNo || 'N/A'}</li>
                                    <li><strong>Pickup:</strong> ${booking.pickup || 'N/A'}</li>
                                    <li><strong>Return:</strong> ${booking.return || 'N/A'}</li>
                                    <li><strong>Status:</strong> ${booking.status || 'N/A'}</li>
                                </ul>
                            </div>
                            `;

                            tooltip.innerHTML = content;
                            tooltip.style.display = 'block';
                            tooltip.style.left = e.pageX + 10 + 'px';
                            tooltip.style.top = e.pageY + 10 + 'px';
                        });

                        // Hide tooltip on outside click
                        document.addEventListener('click', function () {
                        tooltip.style.display = 'none';
                        });


                    }
                }
            });
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const bookingElements = document.querySelectorAll('.booking');
            
            bookingElements.forEach(booking => {
                const text = booking.textContent.toLowerCase();
                if (text.includes(searchTerm) || searchTerm === '') {
                    booking.style.display = 'flex';
                } else {
                    booking.style.display = 'none';
                }
            });
        });

        // Initialize calendar
        generateCalendar();

        // Add some interactive features
        document.querySelectorAll('.btn-view').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.btn-view').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>